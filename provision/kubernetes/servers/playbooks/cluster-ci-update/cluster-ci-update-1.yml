---
- name: Update Cloud-Init Config
  hosts:
    - tiny01
  become: true
  gather_facts: true
  any_errors_fatal: true
  pre_tasks:
    - name: Pausing for 2 seconds...
      ansible.builtin.pause:
        seconds: 2
  tasks:

    - name: set {{ vm.master1_name }} cloud-init config
      command: "qm set {{ vm.master1_id }} --cicustom user=nfs-nas:snippets/{{ vm.master1_name }}-user.yml,network=nfs-nas:snippets/{{ vm.master1_name }}-network.yml,meta=nfs-nas:snippets/meta.yml"

    - name: set {{ vm.worker1_name }} cloud-init config
      command: "qm set {{ vm.worker1_id }} --cicustom user=nfs-nas:snippets/{{ vm.worker1_name }}-user.yml,network=nfs-nas:snippets/{{ vm.worker1_name }}-network.yml,meta=nfs-nas:snippets/meta.yml"
